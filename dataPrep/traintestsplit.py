# -*- coding: utf-8 -*-
"""traintestsplit.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/121hHq1rEVUgmbqUXjaJe_d9Mysl994lR
"""

import os
import numpy as np

# google drive mount
drivepath = '/content/drive/My Drive'
if os.path.isdir(drivepath) == False: # check google drive is mounted or not
  from google.colab import drive
  drive.mount('/content/drive')

def write2txt(tofile, files, idx, filefolder):
# write the content of files with idx indices 
  with open(tofile, "w") as f:
    f.write(filefolder + "\n")
    for i in range(len(idx)):
      filei = idx[i]
      (_, filename) = os.path.split(files[filei])
      f.write(filename + "\n")
 
  return 1


# split the training and test data sets in datasetpath for type epitype
# and writing to file_train and file_test
def traintestset_split(epitype, datasetpath, subname): 
  import glob
  from sklearn.model_selection import train_test_split
  
  filefolder = os.path.join(pubdatasetpath, 'ProcessedData', 'Seg1min', subname)
  
  filenamepattern = os.path.join(filefolder, "*" + epitype +"*.npy")
  files = glob.glob(filenamepattern) # glob all files in the folder
  nfiles = len(files)
  indices = np.arange(nfiles)
  
  # split the training and test data
  idx_train, idx_test = train_test_split(indices, test_size = 0.25)
  idx_train, idx_test = np.sort(idx_train), np.sort(idx_test)

  file_train = os.path.join(datasetpath,"prediction" ,"seg1min_trainset_" + epitype + ".txt")
  file_test = os.path.join(datasetpath,"prediction" ,"seg1min_testset_" + epitype + ".txt")

  write2txt(file_train, files, idx_train, filefolder)
  write2txt(file_test, files, idx_test, filefolder)

  return file_train, file_test


# input parameters
subname = 'Dog_1'
pubdatasetpath = os.path.join(drivepath, 'Projects','Epilepsy', 'Prediction', 'KaggleComp')
traintestset_split("preictal", pubdatasetpath, subname)
traintestset_split("interictal", pubdatasetpath, subname)